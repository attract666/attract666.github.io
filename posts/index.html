<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Posts | JiaHe&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Posts - JiaHe&#39;s Blog">
<meta name="author" content="">
<link rel="canonical" href="https://attract666.github.io/posts/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<link rel="icon" href="https://attract666.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://attract666.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://attract666.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://attract666.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://attract666.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" type="application/rss+xml" href="https://attract666.github.io/posts/index.xml">
<link rel="alternate" hreflang="zh" href="https://attract666.github.io/posts/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script type="text/javascript" async
    src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\[\[', '\]\]']],
                processEscapes: true,
                processEnvironments: true,
                skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                TeX: {
                    equationNumbers: { autoNumber: "AMS" },
                    extensions: ["AMSmath.js", "AMSsymbols.js"]
                }
            },
            "HTML-CSS": {
                availableFonts: ["Arial", "TeX"],
                preferredFont: "TeX",
                webFont: "TeX"
            }
        });

        MathJax.Hub.Queue(function () {
            
            
            
            var all = MathJax.Hub.getAllJax(), i;
            for (i = 0; i < all.length; i += 1) {
                all[i].SourceElement().parentNode.className += ' has-jax';
            }
        });
    </script>

<style>
    code.has-jax {
        font: inherit;
        font-size: 100%;
        background: inherit;
        border: inherit;
        color: #515151;
    }
</style>

<meta property="og:title" content="Posts" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://attract666.github.io/posts/" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Posts"/>
<meta name="twitter:description" content=""/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://attract666.github.io/posts/"
    }
  ]
}
</script>
</head>

<body class="list" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://attract666.github.io/" accesskey="h" title="JiaHe&#39;s Blog (Alt + H)">JiaHe&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://attract666.github.io/posts/" title="All posts">
                    <span class="active">All posts</span>
                </a>
            </li>
            <li>
                <a href="https://attract666.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://attract666.github.io/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="https://attract666.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://attract666.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main"> 
<header class="page-header">
  <h1>
    
  </h1>
</header>


<div class="welcome-message" style="margin-bottom: 60px;">
    <h2 style="font-size: 1.8em; font-weight: bold;  margin-bottom: 20px;">ğŸ‘‹ Welcome to All Posts</h2>
    <p style="color: #888888;">Hi, this is JiaHe. I'm documenting my learning notes in this blog. Hopefully, in exploring one step at a time, I'll find something I'm really interested in, or make sure it's something I'm really interested in ğŸ˜‰.</p>
</div>


<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">æ‰‹æ’•Multihead Attention
    </h2>
  </header>
  <div class="entry-content">
    <p>ä¸ºäº†æ–¹ä¾¿è®²è§£ï¼Œæˆ‘ä»¬å…ˆå¯¹æ–‡æœ¬è¿›è¡Œtokenizeå’Œembeddingã€‚æˆ‘ä»¬ä»…åœ¨è¿™ä¸€æ­¥ä½¿ç”¨äº†é™¤torchä»¥å¤–çš„åº“
text = &#34;This is your first step to understanding LLM&#34; kwargs = {&#34;device_map&#34;: &#34;cuda:3&#34;} tokenizer = AutoTokenizer.from_pretrained(&#34;llama3/Meta-Llama-3-8B&#34;, use_fast=False) model = AutoModelForCausalLM.from_pretrained(&#34;llama3/Meta-Llama-3-8B&#34;, **kwargs) inputs = tokenizer(text, return_tensors=&#34;pt&#34;) inputs = {key: value.to(kwargs[&#34;device_map&#34;]) for key, value in inputs.items()} inputs = model.get_input_embeddings()(inputs[&#34;input_ids&#34;]) ...</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-22 19:21:37 +0800 CST'>åäºŒæœˆ 22, 2024</span></footer>
  <a class="entry-link" aria-label="post link to æ‰‹æ’•Multihead Attention" href="https://attract666.github.io/posts/attetion_code/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">å¦‚ä½•ä½¿ç”¨VSCodeä¼˜é›…åœ°è°ƒè¯•PyTorchå¤šå¡ç¨‹åº
    </h2>
  </header>
  <div class="entry-content">
    <p>åœ¨ä½¿ç”¨VSCodeè°ƒè¯•PyTorchå¤šå¡ç¨‹åºæ—¶ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šå‘ç°å¯åŠ¨è„šæœ¬çš„å‚æ•°å¾ˆå¤šï¼Œå› æ­¤é…ç½®~/.vscode/launch.jsonæ—¶ä½“éªŒä¸ä½³ã€‚å¦‚æœä½ ä¹Ÿé‡åˆ°äº†ä¸Šé¢çš„é—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘æœ¬æ–‡çš„æ–¹æ³•ï¼Œä»¥æ›´ä¼˜é›…çš„æ–¹å¼è°ƒè¯•PyTorchå¤šå¡ç¨‹åºã€‚æœ¬æ–‡ä»¥è°ƒè¯•LLaVAçš„è®­ç»ƒä»£ç ä¸ºä¾‹ã€‚
å®‰è£… debugpy pip install debugpy å†™é…ç½® é¦–å…ˆéœ€è¦é…ç½®çš„è¿˜æ˜¯~/.vscode/launch.jsonï¼Œä½†ä¸å°†å‚æ•°åˆ—è¡¨å¡«å…¥launch.jsonæ–‡ä»¶çš„argsåˆ—è¡¨ä¸åŒã€‚æœ¬æ–‡çš„æ–¹æ³•æ— éœ€åœ¨æ¯æ¬¡è°ƒè¯•æ—¶éƒ½æ›´æ”¹argsåˆ—è¡¨ï¼Œåªéœ€æ›´æ”¹ä½ åŸå§‹çš„è„šæœ¬æ–‡ä»¶ã€‚
æˆ‘ä»¬åªéœ€åœ¨launch.jsonæ–‡ä»¶æ·»åŠ ä¸€ä¸ªæ–°çš„é…ç½®ï¼Œé…ç½®å¦‚ä¸‹ï¼š
{ &#34;name&#34;: &#34;sh_file_debug&#34;, &#34;type&#34;: &#34;debugpy&#34;, &#34;request&#34;: &#34;attach&#34;, &#34;justMyCode&#34;: false, &#34;connect&#34;: { &#34;host&#34;: &#34;localhost&#34;, &#34;port&#34;: 5678 } } ...</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-06 17:16:13 +0800 CST'>åäºŒæœˆ 6, 2024</span></footer>
  <a class="entry-link" aria-label="post link to å¦‚ä½•ä½¿ç”¨VSCodeä¼˜é›…åœ°è°ƒè¯•PyTorchå¤šå¡ç¨‹åº" href="https://attract666.github.io/posts/vscode_debug/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ä»é›¶å¼€å§‹å­¦LLaVA 04
    </h2>
  </header>
  <div class="entry-content">
    <p>æœ¬æ–‡å‚è€ƒå®˜æ–¹æ•™ç¨‹ä»‹ç»å¦‚ä½•è®­ç»ƒLLaVA v1.5 å¤šæ¨¡æ€æ¨¡å‹ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯æœ¬æ–‡å°†ä½¿ç”¨LLama3-8B-Instructä»£æ›¿LLaVA v1.5ä¸­çš„Vicunaã€‚å¦‚æœè¿˜ä¸ç†Ÿæ‚‰LLaVAï¼Œè¯·å…ˆé˜…è¯»å‰é¢ä¸‰ç¯‡æ–‡ç« ï¼šä»é›¶å¼€å§‹å­¦LLaVA 01ï¼Œä»é›¶å¼€å§‹å­¦LLaVA 02å’Œä»é›¶å¼€å§‹å­¦LLaVA 03
</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-05 14:49:36 +0800 CST'>åäºŒæœˆ 5, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ä»é›¶å¼€å§‹å­¦LLaVA 04" href="https://attract666.github.io/posts/llava_04/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ä»é›¶å¼€å§‹å­¦LLaVA 03
    </h2>
  </header>
  <div class="entry-content">
    <p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»ä¸LLaVA v1.5è®­ç»ƒç›¸å…³çš„ä»£ç ã€‚LLaVAè®­ç»ƒåŒ…æ‹¬ä¸¤ä¸ªé˜¶æ®µï¼Œåˆ†åˆ«æ˜¯ç‰¹å¾å¯¹é½å’Œè§†è§‰æŒ‡ä»¤å¾®è°ƒã€‚ç‰¹å¾å¯¹é½å¯åŠ¨çš„è„šæœ¬åœ¨LLaVA/scripts/v1_5/pretrain.shï¼Œè§†è§‰æŒ‡ä»¤å¾®è°ƒå¯åŠ¨çš„è„šæœ¬åœ¨LLaVA/scripts/v1_5/finetune.shã€‚ä¸¤ä¸ªè„šæœ¬æ–‡ä»¶æ‰§è¡Œçš„éƒ½æ˜¯LLaVA/llava/train/train_mem.pyï¼Œåœ¨LLaVA/llava/trainç›®å½•ä¸‹è¿˜æœ‰ä¸€ä¸ªtrain.pyï¼Œè¿™ä¸ªæ‰æ˜¯çœŸæ­£çš„æ€»ä½“è·¯å£ï¼Œä¸åŒç‚¹åœ¨äºæ˜¯å¦ä½¿ç”¨flash_attention_2ã€‚é˜…è¯»çš„å»ºè®®æ˜¯å…ˆæ‰¾åˆ°æ€»ä½“æ€è·¯ï¼Œåœ¨å¯¹ç…§å„ä¸ªéƒ¨åˆ†çš„ä»£ç æ®µåˆ†å—ç†è§£ã€‚
æ¨¡å‹éƒ¨åˆ† åœ¨LLaVA/llava/train/train.pyçš„ç¬¬827è¡Œä¼šå‡ºç°åˆå§‹åŒ–æ¨¡å‹çš„ä»£ç 
model = LlavaLlamaForCausalLM.from_pretrained( model_args.model_name_or_path, cache_dir=training_args.cache_dir, attn_implementation=attn_implementation, torch_dtype=(torch.bfloat16 if training_args.bf16 else None), **bnb_model_from_pretrained_args) ...</p>
  </div>
  <footer class="entry-footer"><span title='2024-12-02 11:27:27 +0800 CST'>åäºŒæœˆ 2, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ä»é›¶å¼€å§‹å­¦LLaVA 03" href="https://attract666.github.io/posts/llava_03/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ä»é›¶å¼€å§‹å­¦LLaVA 02
    </h2>
  </header>
  <div class="entry-content">
    <p>LLaVA-1.5æ‚Ÿé“ LLaVA-1.5åœ¨LLaVAçš„åŸºç¡€ä¸Šåšäº†ä¸€å°éƒ¨åˆ†ä¿®æ”¹ã€‚æ¨¡å‹ä¸ŠæŠŠä¹‹å‰çš„çº¿æ€§å±‚æ¢æˆäº†MLPï¼Œvisual encoderä»ViT-L-14æ¢æˆäº†ViT-L-14-336pxï¼Œæ•°æ®é›†è¿›è¡Œäº†æ‰©å……ï¼ˆVisual Instruction Tuningä»158Kæ¶¨åˆ°äº†665Kï¼‰
è®ºæ–‡è´¡çŒ® è®ºæ–‡ä¸»è¦è´¡çŒ®ï¼š
éªŒè¯äº†LLaVAæ¶æ„çš„é«˜æ•ˆæ€§ï¼šä½¿ç”¨æœ€å°‘çš„è®¡ç®—é‡å’Œæ•°æ®è¾¾åˆ°äº†æ›´ä¼˜çš„æ€§èƒ½ ç®€å•ä¿®æ”¹äº†LLaVAçš„æ¶æ„ åœ¨promptä¸­æ˜ç¡®å›å¤æ ¼å¼ä»¥å¹³è¡¡æ¨¡å‹çš„é•¿çŸ­å›å¤ åˆ†æäº†åˆ†è¾¨ç‡ã€æ•°æ®è§„æ¨¡å’ŒLLMå¤§å°å¯¹æ€§èƒ½çš„å½±å“ ç½‘ç»œæ¶æ„ æ•´ä½“æ¶æ„ä¸Šæ²¡æœ‰å¤ªå¤§çš„æ”¹å˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š
LLaVA v1.5.(Image source:LLaVA v1.5) å¾ˆé‡è¦çš„ä¸€ç‚¹ï¼Œæ˜¯ä½œè€…ä½¿ç”¨äº†AnyResç­–ç•¥ï¼Œæ¥æ‹“å±•è§†è§‰çš„åˆ†è¾¨ç‡ï¼ˆå› ä¸ºCLIPæ”¯æŒçš„æœ€å¤§åˆ†è¾¨ç‡æ˜¯336pxï¼‰
LLaVA v1.5 HD.(Image source:LLaVA v1.5) AnyResç­–ç•¥çš„å…·ä½“æ­¥éª¤ï¼š
å°†é«˜åˆ†è¾¨ç‡å›¾åƒåˆ‡åˆ†æˆå—ï¼Œæ¯å—çš„å¤§å°å–å†³äºvisual encoderèƒ½å¤„ç†çš„åˆ†è¾¨ç‡å¤§å°ã€‚visual encoderå•ç‹¬å¤„ç†æ¯ä¸€å— å°†é«˜åˆ†è¾¨å›¾åƒresizeæˆvisual encoderå¯ä»¥å¤„ç†çš„å¤§å°è¿›è¡Œç¼–ç  å°†ä¸Šé¢ä¸¤æ­¥çš„ç»“æœæ‹¼æ¥èµ·æ¥ä¸€èµ·ä½œä¸ºè§†è§‰ç‰¹å¾ åœ¨LLMä¸­ï¼Œæ¨¡å‹çš„å¹»è§‰å½’å› äºè®­ç»ƒæ•°æ®é›†ä¸­çš„é”™è¯¯æˆ–å¹»è§‰ã€‚ä½œè€…è®¤ä¸ºè¾“å…¥åˆ†è¾¨ç‡ä¸è¶³ä»¥è®©æ¨¡å‹è¯†åˆ«æ•°æ®ä¸­çš„æ‰€æœ‰ç»†èŠ‚ï¼Œæ¨¡å‹å°±ä¼šäº§ç”Ÿå¹»è§‰ã€‚
æ•°æ®é›†è§„æ¨¡ Instruction-following Data.(Image source:LLaVA v1.5) LLaVA-NEXT ä¸LLaVA-1.5ç›¸æ¯”ï¼Œä¸»è¦æœ‰ä»¥ä¸‹æå‡ï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-11-01 18:21:23 +0800 CST'>åä¸€æœˆ 1, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ä»é›¶å¼€å§‹å­¦LLaVA 02" href="https://attract666.github.io/posts/llava_02/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">ä»é›¶å¼€å§‹å­¦LLaVA 01
    </h2>
  </header>
  <div class="entry-content">
    <p>ä»LLaVA-1.0è®ºæ–‡å¼€å§‹ LLaVA: Visual Instruction Tuning(NeurIPS 2023 Oral)
Paper link: https://arxiv.org/abs/2304.08485
Github: https://github.com/haotian-liu/LLaVA
è®ºæ–‡äº®ç‚¹ å¤šæ¨¡æ€ instruction-following æ•°æ®ï¼šä½¿ç”¨GPT4-text-onlyå°†å›¾åƒ-æ–‡æœ¬å¯¹è½¬æ¢æˆé€‚å½“çš„instruction-followingæ ¼å¼ï¼Œä¸»è¦æœ‰å¯¹è¯ï¼ˆConversationï¼‰ã€ç»†èŠ‚æè¿°ï¼ˆDetailed descriptionï¼‰å’Œå¤æ‚æ¨ç†ï¼ˆComplex reasoningï¼‰ä¸‰ç±» å¤šæ¨¡æ€å¤§æ¨¡å‹ï¼šä½¿ç”¨CLIP-L/14ä½œä¸ºè§†è§‰ç¼–ç å™¨ï¼Œå¤§æ¨¡å‹ä½¿ç”¨Vicunaï¼ˆllama-13Bï¼‰ï¼Œä»¥åŠä½¿ç”¨å…¨è¿æ¥å±‚ä½œä¸ºæŠ•å½±å±‚ï¼Œå°†è§†è§‰tokensæ˜ å°„åˆ°LLMçš„word embedding space ç½‘ç»œæ¶æ„ ç»“æ„ä¸Švision encoderä½¿ç”¨çš„æ˜¯CLIP-L/14ï¼ˆä½¿ç”¨å€’æ•°ç¬¬äºŒå±‚å¾—åˆ°çš„ç‰¹å¾ï¼Œå®éªŒè¯æ˜æ•ˆæœä¼šæ›´å¥½ï¼Œä½œè€…åˆ†æè®¤ä¸ºæ˜¯å› ä¸ºæœ€åä¸€å±‚èšç„¦å›¾åƒçš„å…¨å±€ä¿¡æ¯ï¼Œå€’æ•°ç¬¬äºŒå±‚æ›´å…³æ³¨å±€éƒ¨ç‰¹å¾ï¼‰è¿›è¡Œç¼–ç ï¼Œä¹‹åä½¿ç”¨ä¸€ä¸ªæŠ•å½±å±‚ï¼ˆå…¨è¿æ¥å±‚ï¼‰å¯¹é½åˆ°word embeddingï¼Œè¾“å…¥çš„æ–‡æœ¬ç»è¿‡embeddingæ¨¡å‹å¾—åˆ°word embeddingï¼Œä¸¤ä¸ªembeddingæ‹¼æ¥åä¸€èµ·è¾“å…¥ç»™llamaã€‚
LLaVA Architecture.(Image source:LLaVA)æ•°æ®é›†æ„æˆåŠæ•°æ®æ”¶é›†ç»†èŠ‚ è®­ç»ƒåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œç¬¬ä¸€ä¸ªé˜¶æ®µåªæ›´æ–°æŠ•å½±å±‚ï¼Œä½¿ç”¨çš„æ˜¯ä¸€ä¸ªç®€å•è§†è§‰é—®ç­”çš„æ•°æ®é›†ï¼ˆCC3Mä¸­è¿‡æ»¤å‡º595Kï¼‰ï¼›ç¬¬äºŒä¸ªé˜¶æ®µè®­ç»ƒllamaå’ŒæŠ•å½±å±‚ï¼Œæ•°æ®é›†ä½¿ç”¨çš„æ˜¯COCOæ•°æ®é›†ï¼ˆ158Kï¼‰å’ŒScienceQAå¾®è°ƒå‡ºäº†ä¸¤ä¸ªç‰ˆæœ¬ã€‚
é¢„è®­ç»ƒæ•°æ®é›†ï¼ˆCC3Mè¿‡æ»¤ï¼‰ï¼šä½¿ç”¨Spacyï¼ˆNLPåº“ï¼‰ä¸ºCC3Mä¸Šçš„æ¯ä¸ªcaptionæå–åè¯çŸ­è¯­ï¼Œå¹¶è®¡ç®—æ¯ä¸ªå”¯ä¸€åè¯çŸ­è¯­çš„é¢‘ç‡ã€‚å¿½ç•¥æ‰é¢‘ç‡å°äº3çš„åè¯çŸ­è¯­ï¼Œå¯¹äºé¢‘ç‡å¤§äº100çš„åè¯çŸ­è¯­éšæœºé€‰æ‹©ä¸€ä¸ªæ•°é‡ä¸º100çš„å­é›†ã€‚æœ€ç»ˆäº§ç”Ÿ595Kä¸ªå›¾åƒ-æ–‡æœ¬å¯¹ã€‚
CC3M Filtered.(Image source:LLaVA)å°†å›¾åƒæ–‡æœ¬å¯¹é‡‡ç”¨ç®€å•çš„æŒ‡ä»¤æ„é€ ï¼Œç”¨ä¸‹å›¾æ‰€ç¤ºçš„é—®é¢˜æç¤ºGPT-4ï¼Œç”Ÿæˆå¯¹åº”çš„ç­”æ¡ˆã€‚
CC3M image description.(Image source:LLaVA)æŒ‡ä»¤æ ¼å¼å¦‚ä¸‹ï¼š
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-10-23 19:09:20 +0800 CST'>åæœˆ 23, 2024</span></footer>
  <a class="entry-link" aria-label="post link to ä»é›¶å¼€å§‹å­¦LLaVA 01" href="https://attract666.github.io/posts/llava_01/"></a>
</article>

<article class="post-entry"> 
  <header class="entry-header">
    <h2 class="entry-hint-parent">Diffusion Models
    </h2>
  </header>
  <div class="entry-content">
    <p>ä»€ä¹ˆæ˜¯Generative Model? æˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„ç°å®ä¸­çš„å„ç§å›¾ç‰‡ï¼Œè§†ä¸ºå·²ç»è§‚å¯Ÿåˆ°çš„æ•°æ®ï¼Œé‚£ä¹ˆç†è®ºä¸Šå¿…ç„¶å­˜åœ¨ä¸€ä¸ªåˆ†å¸ƒ$p(x)$å¯ä»¥æè¿°å®ƒä»¬ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œå¾ˆè‡ªç„¶çš„æƒ³æ³•å°±æ˜¯ä»è¿™ä¸ªåˆ†å¸ƒ$p(x)$ä¸­é‡‡æ ·ä¸€ä¸ªç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥é€šè¿‡æŸç§æ–¹æ³•å­¦ä¹ åˆ°å¯¹çœŸå®æ•°æ®æ˜ å°„çš„æ•°æ®åˆ†å¸ƒ$p(x)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™ä¸ªåˆ†å¸ƒç”Ÿæˆæ–°çš„æ ·æœ¬ã€‚ä½†æ˜¯ç°å®ç”Ÿæ´»ä¸­ï¼Œè¿™ä¸ªåˆ†å¸ƒ$p(x)$æ˜¯å¤æ‚çš„ï¼Œæˆ‘ä»¬å¾ˆéš¾çœŸçš„å®Œå…¨å»ºæ¨¡å‡ºæ¥ï¼Œå› æ­¤æœ‰æ—¶æˆ‘ä»¬ä¹Ÿä½¿ç”¨å­¦ä¹ åˆ°çš„æ¨¡å‹æ¥è¯„ä¼°è§‚å¯Ÿåˆ°çš„è´§é‡‡æ ·æ•°æ®çš„å¯èƒ½æ€§ã€‚
åœ¨ç°æœ‰çš„Generative Modelæœ‰ä»¥ä¸‹å‡ ä¸ªå¤§æ–¹å‘ã€‚GANå¯¹å¤æ‚åˆ†å¸ƒçš„é‡‡æ ·è¿‡ç¨‹è¿›è¡Œå»ºæ¨¡ï¼Œå¹¶ä»¥å¯¹æŠ—æ–¹å¼å­¦ä¹ ã€‚likelihood-basedæ—¨åœ¨å­¦ä¹ ä¸ºè§‚å¯Ÿåˆ°çš„æ•°æ®æ ·æœ¬åˆ†é…é«˜å¯èƒ½æ€§çš„æ¨¡å‹ï¼Œè¿™åŒ…æ‹¬è‡ªå›å½’æ¨¡å‹å’ŒVAEã€‚energy-basedå°†åˆ†å¸ƒå­¦ä¹ ä¸ºä»»æ„çµæ´»çš„èƒ½é‡å‡½æ•°ï¼Œç„¶åå°†å…¶å½’ä¸€åŒ–ã€‚
AE &amp; VAE æˆ‘ä»¬æ‰€è§‚å¯Ÿåˆ°çš„æ•°æ®å¯ä»¥è¢«è§†ä¸ºä¸€äº›æ›´é«˜å±‚æ¬¡çš„è¡¨ç¤ºçš„å‡½æ•°æ‰€ç”Ÿæˆçš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿‘ä¼¼çš„æè¿°æˆ‘ä»¬è§‚å¯Ÿåˆ°çš„æ•°æ®çš„æ½œåœ¨è¡¨ç¤ºï¼Œç”¨éšæœºå˜é‡$z$è¡¨ç¤ºï¼Œä¹Ÿç§°ä¹‹ä¸ºæ½œå˜é‡ï¼ˆlatent variableï¼‰ã€‚åœ¨ç”Ÿæˆå»ºæ¨¡ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸å¯»æ±‚å­¦ä¹ è¾ƒä½ç»´åº¦çš„æ½œåœ¨è¡¨ç¤ºã€‚è¿™æ˜¯å› ä¸ºå¦‚æœæ²¡æœ‰å¼ºå¤§çš„å…ˆéªŒçŸ¥è¯†ï¼Œè¯•å›¾å­¦ä¹ æ¯”è§‚å¯Ÿæ›´é«˜ç»´çš„è¡¨ç¤ºæ˜¯å¾’åŠ³çš„ã€‚å¦ä¸€æ–¹é¢ï¼Œå­¦ä¹ ä½ç»´æ½œå˜é‡ä¹Ÿå¯ä»¥è¢«è§†ä¸ºä¸€ç§å‹ç¼©å½¢å¼ï¼Œå¹¶ä¸”å¯ä»¥æ½œåœ¨æ­ç¤ºæè¿°è§‚å¯Ÿç»“æœçš„è¯­ä¹‰ä¸Šæœ‰æ„ä¹‰çš„ç»“æ„ã€‚
Autoencoder.(Image source:Lilian Weng) è¿™å°±æ˜¯Autoencoder(AE)çš„æƒ³æ³•ï¼ŒAEåŒ…å«ç¼–ç å™¨$g(.)$å’Œè§£ç å™¨$f(.)$ï¼Œè¾“å…¥$x$çš„ä½ç»´å‹ç¼©è¡¨ç¤ºæ˜¯$z = g_{\phi}(x)$ï¼Œé‡æ„åçš„è¾“å‡ºæ˜¯$xâ€™ = f_{\theta}(g_{\phi}(x))$ã€‚å‚æ•°$(\theta, \phi)$çš„å­¦ä¹ ç›®æ ‡æ˜¯è¾“å…¥ä¸è¾“å‡ºå°½å¯èƒ½ç›¸ä¼¼ï¼Œå³$x \approx xâ€™$ï¼Œè¿™ä¸ªæŸå¤±å‡½æ•°æˆ‘ä»¬ä¹Ÿç§°ä¹‹ä¸ºé‡æ„æŸå¤±ã€‚
Variational Autoencoderï¼ˆVAEï¼‰çš„æ€æƒ³å®é™…ä¸Šä¸AEä¸å¤ªç›¸ä¼¼ã€‚åœ¨VAEä¸­ï¼Œæˆ‘ä»¬ä¸æƒ³å°†è¾“å…¥æ˜ å°„åˆ°å›ºå®šå‘é‡ä¸­ï¼Œè€Œæ˜¯å°†å…¶æ˜ å°„åˆ°åˆ†å¸ƒä¸­ã€‚æˆ‘ä»¬å°†æ­¤åˆ†å¸ƒè®°ä¸º$p_{\theta}$ï¼Œå‚æ•°ä¸º$\theta$ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥æœ‰å¦‚ä¸‹å®šä¹‰ï¼š
å…ˆéªŒæ¦‚ç‡$p_{\theta}(z)$ ä¼¼ç„¶æ€§ï¼ˆlikelihoodï¼‰$p_{\theta}(x | z)$ åéªŒæ¦‚ç‡$p_{\theta}(z | x)$ å‡è®¾æˆ‘ä»¬çŸ¥é“è¿™ä¸ªåˆ†å¸ƒçš„çœŸå®å‚æ•°$\theta^{*}$ï¼Œä¸ºäº†ä½¿å¾—æˆ‘ä»¬çš„ç”Ÿæˆæ¨¡å‹ç”Ÿæˆçœ‹èµ·æ¥æ›´åƒçœŸå®æ•°æ®çš„æ ·æœ¬$x^{(i)}$ï¼Œæˆ‘ä»¬å¯ä»¥ï¼š
å…ˆä»å·²çŸ¥çš„åˆ†å¸ƒ$p_{\theta^{*}}(z)$ä¸­é‡‡æ ·$z^{(i)}$ ç„¶åä»æ¡ä»¶åˆ†å¸ƒ$p_{\theta^{*}}(x | z = z^{(i)})$ä¸­é‡‡æ ·ä¸€ä¸ª$x^{(i)}$ é‚£ä¹ˆè¿™ä¸ªåˆ†å¸ƒæˆ‘ä»¬ä¼¼ä¹å°±å¯ä»¥å†™å‡ºæ¥äº†:
pÎ¸âˆ—(x(i))=âˆ«pÎ¸âˆ—(x(i)|z)pÎ¸âˆ—(z)dz
...</p>
  </div>
  <footer class="entry-footer"><span title='2024-09-09 15:58:57 +0800 CST'>ä¹æœˆ 9, 2024</span></footer>
  <a class="entry-link" aria-label="post link to Diffusion Models" href="https://attract666.github.io/posts/ddpm/"></a>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://attract666.github.io/">JiaHe&#39;s Blog</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
